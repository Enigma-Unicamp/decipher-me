{% extends 'challenge/base.html' %}
{% block title %}Home{% endblock %}
{% block content %}

    {% if request.user.is_authenticated %}

        <h4 style="margin-bottom:30pt">
            Challenges
        </h4>

        {% if challenges %}

            {% if sequential == True %}
                {% for chall in challenges %}
                    <form action="{% url 'challenge:challenge' %}" method="post">
                        {% csrf_token %}
                        {% if chall.id_chall == user.level %}
                            <i class="material-icons" style="vertical-align: middle">lock</i>
                            <input type="submit" value="{{ chall.title }}" class="btn">
                        {% elif chall.id_chall > user.level %}
                            <i class="material-icons" style="vertical-align: middle">lock</i>
                            <input type="submit" value="{{ chall.title }}" class="btn" disabled>
                        {% else %}
                            <i class="material-icons" style="vertical-align: middle">lock_open</i>
                            <input type="submit" value="{{ chall.title }}" class="btn">
                        {% endif %}
                        <input name="id_chall" type="hidden" value={{ chall.id_chall }}>
                    </form><br/>
                {% endfor %}

            {% else %}
                {% for chall in challenges %}
                    <form action="{% url 'challenge:challenge' %}" method="post">
                        {% csrf_token %}
                        {% if chall.id_chall|stringformat:"i" in request.user.challenges_done %}
                            <i class="material-icons" style="vertical-align: middle">lock_open</i>
                            <input type="submit" value="{{ chall.title }}: {{ chall.points }} point(s)" class="btn">
                        {% else %}
                            <i class="material-icons" style="vertical-align: middle">lock</i>
                            <input type="submit" value="{{ chall.title }}: {{ chall.points }} point(s)" class="btn">
                        {% endif %}
                        <input name="id_chall" type="hidden" value={{ chall.id_chall }}>
                    </form><br/>
                {% endfor %}
            {% endif %}
            
        {% else %}
            We still don't have any challenges. Come back soon.
        {% endif %}

    {% else %}

        <h4 style="margin-bottom:30pt">
            Welcome! Please login
        </h4>

    {% endif %}


{% endblock %}
